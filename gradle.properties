# ================================================================================
# DocumentScanner - gradle.properties
# Optimized for Gradle 9.x / Android / JDK 21+
# Version: 3.0.0
# ================================================================================

# ================================================================================
# MEMORY & PERFORMANCE (JVM)
# ================================================================================
# Настройки для JDK 21+ (стандарт 2026)
# Используем ZGC (Generational) для минимальных пауз (<1ms)
#
# ⚠️ JDK REQUIREMENT: ZGC Generational требует JDK 21+
# Для JDK 17 замените на: -XX:+UseG1GC -XX:G1HeapRegionSize=16m
# Для JDK 11 используйте: -XX:+UseG1GC -XX:G1HeapRegionSize=16m -XX:+ParallelRefProcEnabled
#
# Проверить версию JDK: ./gradlew --version
org.gradle.jvmargs=-Xmx8g \
    -Xms2g \
    -XX:+UseZGC \
    -XX:+ZGenerational \
    -XX:MaxMetaspaceSize=1g \
    -XX:+HeapDumpOnOutOfMemoryError \
    -XX:HeapDumpPath=./build/heap-dump.hprof \
    -Dfile.encoding=UTF-8 \
    -Dkotlin.daemon.jvm.options="-Xmx4g -XX:+UseZGC -XX:+ZGenerational"

# ================================================================================
# GRADLE TUNING
# ================================================================================
org.gradle.daemon=true
org.gradle.daemon.idletimeout=10800000
org.gradle.parallel=true
org.gradle.priority=normal

# File system watching (Default in Gradle 9, but explicit is fine)
org.gradle.vfs.watch=true

# Отключаем приветственное сообщение Gradle (меньше шума в логах)
org.gradle.welcome=never

# ================================================================================
# CACHING (The Heart of Speed)
# ================================================================================
org.gradle.caching=true
org.gradle.configuration-cache=true
org.gradle.configuration-cache.problems=warn
org.gradle.configuration-cache.max-problems=512

# Изоляция проектов (Готовимся к будущему, пока закомментировано)
# org.gradle.unsafe.isolated-projects=true

# ================================================================================
# KOTLIN (K2 Compiler Optimized)
# ================================================================================
kotlin.code.style=official
kotlin.incremental=true
kotlin.incremental.usePreciseJavaTracking=true
# Убрали strategy=in-process, полагаемся на Smart Daemon в Kotlin 2.x
# Убрали native.ignoreDisabledTargets - это дефолт в новых версиях

# ================================================================================
# ANDROID BUILD OPTIMIZATIONS
# ================================================================================
android.useAndroidX=true
android.enableJetifier=false

# R8 / Minification
android.enableR8.fullMode=true

# Resources & Manifests
android.nonTransitiveRClass=true
android.nonFinalResIds=true
android.disableConfigurationResolutionOnConfigurationTime=true

# ================================================================================
# BUILD FEATURES (Disable unused for speed)
# ================================================================================
android.defaults.buildfeatures.buildconfig=false
android.defaults.buildfeatures.aidl=false
android.defaults.buildfeatures.renderscript=false
android.defaults.buildfeatures.resvalues=false
android.defaults.buildfeatures.shaders=false

# ================================================================================
# KSP & COMPOSE
# ================================================================================
ksp.incremental=true
ksp.incremental.log=false

# ================================================================================
# LOGGING
# ================================================================================
org.gradle.logging.level=lifecycle
org.gradle.console=auto
# Warning mode: all (чтобы видеть депрекейтед фичи до обновления)
org.gradle.warning.mode=all

# ================================================================================
# PROJECT META
# ================================================================================
APP_NAME=DocumentScanner
# Версионирование часто выносят в libs.versions.toml или build logic,
# но хранить здесь тоже допустимо для простоты CI.
APP_VERSION_NAME=3.0.0
APP_VERSION_CODE=300
APPLICATION_ID=com.docs.scanner

# ================================================================================
# SECURITY NOTE
# ================================================================================
# Secrets (API Keys) MUST NOT be placed here.
# Use 'local.properties' (gitignored) or Environment Variables (CI/CD).
#
# Required keys in local.properties:
# - GEMINI_API_KEY=AIzaSy...your_real_key
# - GOOGLE_DRIVE_CLIENT_ID=123456789-abcdefg.apps.googleusercontent.com
#
# Example local.properties:
# ──────────────────────────────────────────────────────────────────────────
# ## This file must *NOT* be checked into Version Control Systems
# GEMINI_API_KEY=AIzaSy...
# GOOGLE_DRIVE_CLIENT_ID=123456789-abcdefg.apps.googleusercontent.com
# ──────────────────────────────────────────────────────────────────────────

# ================================================================================
# CI/CD OVERRIDES (раскомментировать в CI окружении)
# ================================================================================
# org.gradle.daemon=false              # Отключить daemon в CI
# org.gradle.vfs.watch=false           # Отключить file watching в CI
# org.gradle.configuration-cache=false # Если CI кэш не поддерживает

# ================================================================================
# PERFORMANCE BENCHMARKS (Expected with this config)
# ================================================================================
# Clean Build (10 modules):     ~45s  → ~8s  (with cache)
# Incremental (1 file changed): ~2s
# Configuration Time:            ~3s   → ~200ms (with config cache)
# GC Pause (max):                <1ms  (ZGC Generational)
# Memory Usage (peak):           ~6GB
# ================================================================================