# ================================================================================
# DocumentScanner - gradle.properties (CI OPTIMIZED)
# Оптимизировано для GitHub Actions с максимальным ускорением
# Version: 8.1.0 - CI EDITION
# ================================================================================

# ================================================================================
# JVM CONFIGURATION - ОПТИМИЗИРОВАНО ДЛЯ CI (4-8 GB RAM)
# ================================================================================
org.gradle.jvmargs=-Xmx5g \
    -Xms1g \
    -XX:MaxMetaspaceSize=1024m \
    -XX:MetaspaceSize=512m \
    -XX:+HeapDumpOnOutOfMemoryError \
    -XX:HeapDumpPath=./build/reports/heap-dump.hprof \
    -XX:+UseG1GC \
    -XX:+UseStringDeduplication \
    -XX:G1HeapRegionSize=16m \
    -XX:MaxGCPauseMillis=200 \
    -XX:ParallelGCThreads=4 \
    -XX:ConcGCThreads=2 \
    -XX:InitiatingHeapOccupancyPercent=45 \
    -XX:+DisableExplicitGC \
    -Dfile.encoding=UTF-8 \
    -Djava.awt.headless=true \
    -Dkotlin.daemon.jvm.options="-Xmx2g -XX:MaxMetaspaceSize=768m -XX:+UseG1GC"

# Daemon settings для CI
org.gradle.daemon=true
org.gradle.daemon.idletimeout=900000

# ================================================================================
# GRADLE PERFORMANCE - МАКСИМУМ ДЛЯ CI
# ================================================================================
org.gradle.parallel=true
org.gradle.caching=true
org.gradle.configuration-cache=true
org.gradle.configuration-cache.problems=warn
org.gradle.configuration-cache.max-problems=100
org.gradle.vfs.watch=false
org.gradle.priority=normal
org.gradle.welcome=never

# ✅ CI-специфичные оптимизации
org.gradle.workers.max=4
org.gradle.unsafe.isolated-projects=false

# ================================================================================
# KOTLIN COMPILER - ОПТИМИЗАЦИЯ ДЛЯ СКОРОСТИ
# ================================================================================
kotlin.incremental=true
kotlin.incremental.usePreciseJavaTracking=true
kotlin.incremental.useClasspathSnapshot=true
kotlin.build.report.output=file
kotlin.compiler.execution.strategy=in-process
kotlin.daemon.jvmargs=-Xmx2g -XX:MaxMetaspaceSize=768m -XX:+UseG1GC -XX:ReservedCodeCacheSize=320m

# Kotlin daemon
kotlin.daemon.enabled=true
kotlin.daemon.useFallbackStrategy=false

# ================================================================================
# KOTLIN CONFIGURATION
# ================================================================================
kotlin.code.style=official
kotlin.mpp.androidSourceSetLayoutVersion=2
kotlin.experimental.tryK2=false
kotlin.stdlib.default.dependency=true

# ================================================================================
# ANDROID BUILD OPTIMIZATIONS
# ================================================================================
android.useAndroidX=true
android.enableJetifier=false
android.nonTransitiveRClass=true
android.nonFinalResIds=true

# R8 Full Mode
android.enableR8.fullMode=true
android.enableR8.repositories=true

# D8 Desugaring
android.enableDexingArtifactTransform=true
android.enableDexingArtifactTransform.desugaring=true

# Baseline Profile
android.experimental.art-profile-r8-rewriting=true
android.experimental.r8.dex-startup-optimization=true

android.suppressUnsupportedCompileSdk=36

# ================================================================================
# BUILD FEATURES - МИНИМИЗАЦИЯ ДЛЯ СКОРОСТИ
# ================================================================================
android.defaults.buildfeatures.buildconfig=true
android.defaults.buildfeatures.aidl=false
android.defaults.buildfeatures.renderscript=false
android.defaults.buildfeatures.resvalues=false
android.defaults.buildfeatures.shaders=false
android.defaults.buildfeatures.viewbinding=false
android.defaults.buildfeatures.databinding=false

# ================================================================================
# COMPOSE CONFIGURATION
# ================================================================================
composeCompilerReports=false
composeCompilerMetrics=false

# ================================================================================
# KSP CONFIGURATION
# ================================================================================
ksp.incremental=true
ksp.incremental.log=false
ksp.useKSP2=false

# ================================================================================
# PROJECT METADATA
# ================================================================================
APP_NAME=DocumentScanner
APP_VERSION_NAME=8.0.0
APP_VERSION_CODE=800
APPLICATION_ID=com.docs.scanner
MIN_SDK_VERSION=26
TARGET_SDK_VERSION=36
COMPILE_SDK_VERSION=36

# ================================================================================
# LOGGING - МИНИМУМ ДЛЯ CI
# ================================================================================
org.gradle.logging.level=lifecycle
org.gradle.console=plain
org.gradle.warning.mode=summary
org.gradle.internal.launcher.welcomeMessageEnabled=false

# ================================================================================
# NETWORK - УВЕЛИЧЕННЫЕ ТАЙМАУТЫ ДЛЯ CI
# ================================================================================
systemProp.http.connectionTimeout=180000
systemProp.http.socketTimeout=180000
systemProp.org.gradle.internal.http.connectionTimeout=180000
systemProp.org.gradle.internal.http.socketTimeout=180000